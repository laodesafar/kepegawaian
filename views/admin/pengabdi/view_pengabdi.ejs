<%- include('../../partials/header.ejs') %>
  <!-- Page Wrapper -->
  <div id="wrapper">

<%- include('../../partials/sidebar.ejs') %>

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

      <!-- Main Content -->
      <div id="content">

<%- include('../../partials/navbar.ejs') %>

        <!-- Begin Page Content -->
        <div class="container-fluid">
           <%- include('../../partials/message.ejs') %>

          <!-- Page Heading -->
          <h1 class="h3 mb-4 text-gray-800">Data Pengabdi</h1>
          <!-- End of Page Heading -->

          <%- include('tabel_pengabdi.ejs') %>

        </div>
        <!-- /.container-fluid -->

      </div>
      <!-- End of Main Content -->

<%- include('../../partials/footer.ejs') %>

    </div>
    <!-- End of Content Wrapper -->

  </div>
  <!-- End of Page Wrapper -->

  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>

  <!-- Logout Modal-->
  <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">Ã—</span>
          </button>
        </div>
        <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <a class="btn btn-primary" href="login.html">Logout</a>
        </div>
      </div>
    </div>
  </div>

<%- include('add_pengabdi') %>
<%- include('edit_pengabdi') %>
<%- include('../../partials/hapus_modal') %>
<%- include('../../partials/js.ejs') %>

<script>
  $("#dataTable").on('click', '.button-update', function(){
    let id = $(this).data('id');
    let nip = $(this).data('nip');
    let nama  = $(this).data('nama');
    let tempatLahir = $(this).data('tempatlahir');
    let tanggalLahir = $(this).data('tanggallahir');
    let agama = $(this).data('agama');
    let jenisKelamin = $(this).data('jeniskelamin');
    let golonganDarah = $(this).data('golongandarah');
    let statusPernikahan = $(this).data('statuspernikahan');
    let alamat = $(this).data('alamat');
    let telpon = $(this).data('telpon');
    let email = $(this).data('email');
    let tmtGaji = $(this).data('tmtgaji');
    let tmtGolongan = $(this).data('tmtgolongan');
    let tmtKerja = $(this).data('tmtkerja');
    let jenisPengabdiId = $(this).data('jenispengabdiid');
    let jenis = $(this).data('jenis');
    let unitId = $(this).data('unitid');

    $('#editModal').modal('show');
    if ( jenis == true ) {
      $('.nip2').text("11");
      $('.hilang').show();
      $('.tmtGolongan').attr("required", true);
      $('.tmtGaji').attr("required", true);
      } else  {
      $('.nip2').text("12");
      $('.hilang').hide();
      $('.tmtGolongan').attr("required", false);
      $('.tmtGaji').attr("required", false);
    }

    $('.id').val(id);
    $('.nip').val(nip);
    $('.nama').val(nama);
    $('.tempatLahir').val(tempatLahir);
    $('.tanggalLahir').val(tanggalLahir);
    $('.agama').val(agama);
    if (jenisKelamin == "Laki - Laki") {
      $('.laki').attr("checked", "checked");
    } else {
      $('.perempuan').attr("checked", "checked");
    }
    $('.golonganDarah').val(golonganDarah);
    $('.statusPernikahan').val(statusPernikahan);
    $('.alamat').val(alamat);
    $('.telpon').val(telpon);
    $('.email').val(email);
    $('.tmtGaji').val(tmtGaji);
    $('.tmtGolongan').val(tmtGolongan);
    $('.tmtKerja').val(tmtKerja);
    $('.jenisPengabdiId').val(jenisPengabdiId);
    $('.unitId').val(unitId);
  })

  $(".jenisPengabdiId").on('change', function(){
    let jenis = $('option:selected',this).data("jenis");

    if ( jenis == true ) {
      $('.nip2').text("11");
      $('.hilang').show();
      $('.tmtGolongan').attr("required", true);
      $('.tmtGaji').attr("required", true);
      } else {
      $('.nip2').text("12");
      $('.hilang').hide();
      $('.tmtGolongan').attr("required", false);
      $('.tmtGaji').attr("required", false);
    }
  })


  $("#dataTable").on('click', '.button-hapus', function(){
    let id = $(this).data('id');
    let nama  = $(this).data('nama');
    let title = "Hapus Pengabdi";
    let actionValue = `/admin/pengabdi/${id}?_method=DELETE`;
    let detail = `Apakah anda yakin ingin menghapus ${nama} ?`;

    $('.action').attr("action",actionValue);
    $('.hapusDetail').text(detail);
    $('.modal-title').text(title);

  })

  $('#unit').selectpicker();


</script>
<%- include('../../partials/validation.ejs') %>
<%- include('../../partials/foto_input.ejs') %>